remarks test/torsiontest8.inp
remarks test torsion topology generation for base body with only two atoms
remarks

Topology
!       
!       
!       This file was generated by PRODRG version 071121.0636
!       PRODRG written/copyrighted by Daan van Aalten
!       and Alexander Schuettelkopf
!       
!       Questions/comments to dava@davapc1.bioch.dundee.ac.uk
!       
!       When using this software in a publication, cite:
!       A. W. Schuettelkopf and D. M. F. van Aalten (2004).
!       PRODRG - a tool for high-throughput crystallography
!       of protein-ligand complexes.
!       Acta Crystallogr. D60, 1355--1363.
!       
!       
!  *** NOTE *** IF YOU USE MORE THAN ONE PRODRG-GENERATED TOPOLOGY IN CNS,
!               PLEASE CAREFULLY READ THE FAQ AS THIS MAY CAUSE PROBLEMS
!
!
set echo=false end
AUTOGENERATE  ANGLES=FALSE  END
MASS  OP1   15.9994   ! equivalent to    OA
MASS  HPAA   1.0080   ! equivalent to    HO
MASS  CP1   14.0270   ! equivalent to   CH2
MASS  CP_Y  12.0110   ! equivalent to   CH0
MASS  CP3   14.0270   ! equivalent to   CH2
MASS  OP3   15.9994   ! equivalent to    OA
MASS  HPAC   1.0080   ! equivalent to    HO
MASS  NP_Y  14.0067   ! equivalent to    NL
MASS  HPAE   1.0080   ! equivalent to     H
MASS  HPAF   1.0080   ! equivalent to     H
MASS  HPAD   1.0080   ! equivalent to     H
MASS  CP2   14.0270   ! equivalent to   CH2
MASS  OP2   15.9994   ! equivalent to    OA
MASS  HPAB   1.0080   ! equivalent to    HO

Residue TRS  
GROUP
  ATOM O1   TYPE= OP1  CHARGE=-0.169 END
  ATOM HAA  TYPE= HPAA CHARGE= 0.027 END
  ATOM C1   TYPE= CP1  CHARGE= 0.032 END
  ATOM C    TYPE= CP_Y CHARGE= 0.065 END
  ATOM C3   TYPE= CP3  CHARGE= 0.032 END
  ATOM O3   TYPE= OP3  CHARGE=-0.168 END
  ATOM HAC  TYPE= HPAC CHARGE= 0.027 END
  ATOM N    TYPE= NP_Y CHARGE= 0.231 END
  ATOM HAE  TYPE= HPAE CHARGE= 0.011 END
  ATOM HAF  TYPE= HPAF CHARGE= 0.010 END
  ATOM HAD  TYPE= HPAD CHARGE= 0.011 END
  ATOM C2   TYPE= CP2  CHARGE= 0.032 END
  ATOM O2   TYPE= OP2  CHARGE=-0.168 END
  ATOM HAB  TYPE= HPAB CHARGE= 0.027 END

  BOND O1   HAA 
  BOND O1   C1  
  BOND C1   C   
  BOND C    C3  
  BOND C    N   
  BOND C    C2  
  BOND C3   O3  
  BOND O3   HAC 
  BOND N    HAE 
  BOND N    HAF 
  BOND N    HAD 
  BOND C2   O2  
  BOND O2   HAB 

  ANGLE HAA  O1   C1  
  ANGLE O1   C1   C   
  ANGLE C1   C    C3  
  ANGLE C1   C    N   
  ANGLE C1   C    C2  
  ANGLE C3   C    N   
  ANGLE C3   C    C2  
  ANGLE N    C    C2  
  ANGLE C    C3   O3  
  ANGLE C3   O3   HAC 
  ANGLE C    N    HAE 
  ANGLE C    N    HAF 
  ANGLE C    N    HAD 
  ANGLE HAE  N    HAF 
  ANGLE HAE  N    HAD 
  ANGLE HAF  N    HAD 
  ANGLE C    C2   O2  
  ANGLE C2   O2   HAB 

  IMPROPER C    C1   N    C3  
  IMPROPER N    C    HAF  HAE 

  DIHEDRAL C    C1   O1   HAA 
  DIHEDRAL O1   C1   C    C2  
  DIHEDRAL O3   C3   C    C1  
  DIHEDRAL C1   C    N    HAD 
  DIHEDRAL O2   C2   C    C1  
  DIHEDRAL C    C3   O3   HAC 
  DIHEDRAL C    C2   O2   HAB 
END

end


parameter
      
!       
!       This file was generated by PRODRG version 071121.0636
!       PRODRG written/copyrighted by Daan van Aalten
!       and Alexander Schuettelkopf
!       
!       Questions/comments to dava@davapc1.bioch.dundee.ac.uk
!       
!       When using this software in a publication, cite:
!       A. W. Schuettelkopf and D. M. F. van Aalten (2004).
!       PRODRG - a tool for high-throughput crystallography
!       of protein-ligand complexes.
!       Acta Crystallogr. D60, 1355--1363.
!       
!       
!  *** NOTE *** IF YOU USE MORE THAN ONE PRODRG-GENERATED TOPOLOGY IN CNS,
!               PLEASE CAREFULLY READ THE FAQ AS THIS MAY CAUSE PROBLEMS
!
!
set echo=off message=on end

evaluate ($pd_x = 1.0)

eval ($pd_v=$pd_x* 15000.0) BOND  OP1   HPAA $pd_v   1.000
eval ($pd_v=$pd_x* 16000.0) BOND  OP1   CP1  $pd_v   1.430
eval ($pd_v=$pd_x* 16000.0) BOND  CP1   CP_Y $pd_v   1.530
eval ($pd_v=$pd_x* 16000.0) BOND  CP_Y  CP3  $pd_v   1.530
eval ($pd_v=$pd_x* 18000.0) BOND  CP_Y  NP_Y $pd_v   1.470
eval ($pd_v=$pd_x* 16000.0) BOND  CP_Y  CP2  $pd_v   1.530
eval ($pd_v=$pd_x* 16000.0) BOND  CP3   OP3  $pd_v   1.430
eval ($pd_v=$pd_x* 15000.0) BOND  OP3   HPAC $pd_v   1.000
eval ($pd_v=$pd_x* 17900.0) BOND  NP_Y  HPAE $pd_v   1.000
eval ($pd_v=$pd_x* 17900.0) BOND  NP_Y  HPAF $pd_v   1.000
eval ($pd_v=$pd_x* 17900.0) BOND  NP_Y  HPAD $pd_v   1.000
eval ($pd_v=$pd_x* 16000.0) BOND  CP2   OP2  $pd_v   1.430
eval ($pd_v=$pd_x* 15000.0) BOND  OP2   HPAB $pd_v   1.000

eval ($pd_v=$pd_x*   760.0) ANGLE  HPAA  OP1   CP1  $pd_v 109.500
eval ($pd_v=$pd_x*   880.0) ANGLE  OP1   CP1   CP_Y $pd_v 109.500
eval ($pd_v=$pd_x*   880.0) ANGLE  CP1   CP_Y  CP3  $pd_v 109.500
eval ($pd_v=$pd_x*   880.0) ANGLE  CP1   CP_Y  NP_Y $pd_v 109.500
eval ($pd_v=$pd_x*   880.0) ANGLE  CP1   CP_Y  CP2  $pd_v 109.500
eval ($pd_v=$pd_x*   880.0) ANGLE  CP3   CP_Y  NP_Y $pd_v 109.500
eval ($pd_v=$pd_x*   880.0) ANGLE  CP3   CP_Y  CP2  $pd_v 109.500
eval ($pd_v=$pd_x*   880.0) ANGLE  NP_Y  CP_Y  CP2  $pd_v 109.500
eval ($pd_v=$pd_x*   880.0) ANGLE  CP_Y  CP3   OP3  $pd_v 109.500
eval ($pd_v=$pd_x*   760.0) ANGLE  CP3   OP3   HPAC $pd_v 109.500
eval ($pd_v=$pd_x*   720.0) ANGLE  CP_Y  NP_Y  HPAE $pd_v 109.500
eval ($pd_v=$pd_x*   720.0) ANGLE  CP_Y  NP_Y  HPAF $pd_v 109.500
eval ($pd_v=$pd_x*   720.0) ANGLE  CP_Y  NP_Y  HPAD $pd_v 109.500
eval ($pd_v=$pd_x*   640.0) ANGLE  HPAE  NP_Y  HPAF $pd_v 109.500
eval ($pd_v=$pd_x*   640.0) ANGLE  HPAE  NP_Y  HPAD $pd_v 109.500
eval ($pd_v=$pd_x*   640.0) ANGLE  HPAF  NP_Y  HPAD $pd_v 109.500
eval ($pd_v=$pd_x*   880.0) ANGLE  CP_Y  CP2   OP2  $pd_v 109.500
eval ($pd_v=$pd_x*   760.0) ANGLE  CP2   OP2   HPAB $pd_v 109.500

eval ($pd_v=$pd_x*   400.0) IMPR  CP_Y  CP1   NP_Y  CP3  $pd_v 0  35.264
eval ($pd_v=$pd_x*   400.0) IMPR  NP_Y  CP_Y  HPAF  HPAE $pd_v 0  35.264

!eval ($pd_v=$pd_x*     0.9) DIHE  CP_Y  CP1   OP1   HPAA $pd_v 3   0.000
!eval ($pd_v=$pd_x*    19.6) DIHE  OP1   CP1   CP_Y  CP2  $pd_v 3   0.000
!eval ($pd_v=$pd_x*    19.6) DIHE  OP3   CP3   CP_Y  CP1  $pd_v 3   0.000
!eval ($pd_v=$pd_x*     8.1) DIHE  CP1   CP_Y  NP_Y  HPAD $pd_v 3   0.000
!eval ($pd_v=$pd_x*    19.6) DIHE  OP2   CP2   CP_Y  CP1  $pd_v 3   0.000
!eval ($pd_v=$pd_x*     0.9) DIHE  CP_Y  CP3   OP3   HPAC $pd_v 3   0.000
!eval ($pd_v=$pd_x*     0.9) DIHE  CP_Y  CP2   OP2   HPAB $pd_v 3   0.000

eval ($pd_v=$pd_x*     0) DIHE  CP_Y  CP1   OP1   HPAA $pd_v 3   0.000
eval ($pd_v=$pd_x*     0) DIHE  OP1   CP1   CP_Y  CP2  $pd_v 3   0.000
eval ($pd_v=$pd_x*     0) DIHE  OP3   CP3   CP_Y  CP1  $pd_v 3   0.000
eval ($pd_v=$pd_x*     0) DIHE  CP1   CP_Y  NP_Y  HPAD $pd_v 3   0.000
eval ($pd_v=$pd_x*     0) DIHE  OP2   CP2   CP_Y  CP1  $pd_v 3   0.000
eval ($pd_v=$pd_x*     0) DIHE  CP_Y  CP3   OP3   HPAC $pd_v 3   0.000
eval ($pd_v=$pd_x*     0) DIHE  CP_Y  CP2   OP2   HPAB $pd_v 3   0.000


NBONds
  TOLERANCE=0.5 NBXMOD=5 WMIN=1.5
  REPEL=1.0 REXPONENT=4 IREXPONENT=1 RCONST=16.0
  CTONNB=5.5 CTOFNB=6.0 CUTNB=7.0
END

NONBONDED  OP1   0.10000 2.58361 0.10000 2.31634
NONBONDED  HPAA  0.10000 1.42544 0.10000 1.15817
NONBONDED  CP1   0.10000 3.29633 0.10000 3.02906
NONBONDED  CP_Y  0.10000 3.29633 0.10000 3.02906
NONBONDED  CP3   0.10000 3.29633 0.10000 3.02906
NONBONDED  OP3   0.10000 2.58361 0.10000 2.31634
NONBONDED  HPAC  0.10000 1.42544 0.10000 1.15817
NONBONDED  NP_Y  0.10000 2.67270 0.10000 2.40543
NONBONDED  HPAE  0.10000 1.42544 0.10000 1.15817
NONBONDED  HPAF  0.10000 1.42544 0.10000 1.15817
NONBONDED  HPAD  0.10000 1.42544 0.10000 1.15817
NONBONDED  CP2   0.10000 3.29633 0.10000 3.02906
NONBONDED  OP2   0.10000 2.58361 0.10000 2.31634
NONBONDED  HPAB  0.10000 1.42544 0.10000 1.15817

end

segment
 molecule
   name=TRS number=1
 end
end

coor
ATOM   1180  C   TRS     1     -15.715  31.011  43.030  0.33 29.31           C  
ATOM   1181  C1  TRS     1     -14.271  31.251  42.652  0.33 29.03           C  
ATOM   1182  C2  TRS     1     -16.506  32.313  42.904  0.33 29.00           C  
ATOM   1183  C3  TRS     1     -16.347  30.067  42.070  0.33 29.02           C  
ATOM   1184  N   TRS     1     -15.905  30.457  44.403  0.33 29.38           N  
ATOM   1185  O1  TRS     1     -13.356  30.468  43.321  0.33 29.36           O  
ATOM   1186  O2  TRS     1     -15.719  33.372  42.500  0.33 29.37           O  
ATOM   1189  O3  TRS     1     -16.575  28.944  42.821  0.33 29.35           O  
END

delete selection=( not known ) end


 connectivity print=true end

 flags exclude * include bond angle impr dihe vdw elec ? end

!!! mini lbfgs nstep=100 end
     
 evaluate ($start_temp=900)
 evaluate ($fbeta=200)

 set seed=12345 end

 do (fbeta=$fbeta) ( all )

 do (vx=maxwell($start_temp)) ( all )
 do (vy=maxwell($start_temp)) ( all )
 do (vz=maxwell($start_temp)) ( all )

 evaluate ($traj_outfile="torsiontest8" + "_traj.crd")

!
! test two-atom base body with several joints
! ===========================================

 dynamics torsion
         topology      
            kdihmax = 95.0                  
         end
         timestep=0.0005 
         nstep=100
         nprint=10
         cmremove=true
         cmperiodic=100
         tcoupling=true
         temperature=$start_temp
!         ascii=false
!         nsavc=100
!         trajectory=$traj_outfile
 end

!   {- read the trajectory file and write individual coordinate files
!       and the combined coordinate file for VMD -}
!      close $traj_outfile end
!       evaluate ($traj_combined="torsiontest8" + "_traj.pdb")
!       evaluate ($nstruc=1)
!       evaluate ($max_struc=10000/100)
!       while ($nstruc <= $max_struc) loop traj
!          
!          if ($nstruc=1) then
!              read traj ascii=false input=$traj_outfile begin= 100 skip= 100 stop= 10000 end
!          else 
!              read traj next end
!          end if
!
!          evaluate ($traj_coorfile="torsiontest8" + "_" + encode($nstruc)+".pdb")
!          write coordinates output=$traj_coorfile format=PDBO end
!          write coordinates output=$traj_combined format=PDBO end
!          open $traj_combined access=append end
!
!          evaluate ($nstruc=$nstruc+1)
!       end loop traj
!       close $traj_combined end

!
! test 3-atom situations: 2-atom base body with a joint
! =====================================================

delete selection=( not ( name C or name C1 or name O1 ) ) end

dynamics torsion
         topology      
            kdihmax = 95.0                  
         end
         timestep=0.0005 
         nstep=100
         nprint=10
         cmremove=true
         cmperiodic=100
         tcoupling=true
         temperature=$start_temp
!!         ascii=false
!!         nsavc=100
!!         trajectory=$traj_outfile
end


!
! test diaatomic molecules
! ========================

delete selection=( name c ) end

dynamics torsion
         topology      
            kdihmax = 95.0                  
         end
         timestep=0.0005 
         nstep=100
         nprint=10
         cmremove=true
         cmperiodic=100
         tcoupling=true
         temperature=$start_temp
!!         ascii=false
!!         nsavc=100
!!         trajectory=$traj_outfile
end

 
stop

