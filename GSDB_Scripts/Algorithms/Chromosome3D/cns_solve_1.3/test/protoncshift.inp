remarks file: test_carb.inp
remarks test file for carbon chemical shift refinement code
remarks  

parameter                                             { set energy parameters }
    @CNS_TOPPAR:protein-allhdg5-4.param
    nbonds                 
        atom  nbxmod -3  tolerance 0.5  
        repel 0.75  rcon 4.0  rexp 2  cutnb 4.5   
    end
end

structure 
data_cns_mtf

_cns_mtf.title
; FILENAME="/data/rwgk/test/tmp.mtf"
  DATE:18-Nov-98  14:17:43       created by user: rwgk
  VERSION:0.4a
;

loop_
_cns_mtf_atom.id
_cns_mtf_atom.segment_id
_cns_mtf_atom.residue_id
_cns_mtf_atom.residue_name
_cns_mtf_atom.atom_name
_cns_mtf_atom.chemical_type
_cns_mtf_atom.charge
_cns_mtf_atom.atom_mass
1 ' ' '1' 'MET' 'N' 'NH3' -0.100000 14.0070
2 ' ' '1' 'MET' 'HT1' 'HC' 0.260000 1.00800
3 ' ' '1' 'MET' 'HT2' 'HC' 0.260000 1.00800
4 ' ' '1' 'MET' 'HT3' 'HC' 0.260000 1.00800
5 ' ' '1' 'MET' 'CA' 'CT' 0.220000 12.0110
6 ' ' '1' 'MET' 'HA' 'HA' 0.100000 1.00800
7 ' ' '1' 'MET' 'CB' 'CT' -0.200000 12.0110
8 ' ' '1' 'MET' 'HB1' 'HA' 0.100000 1.00800
9 ' ' '1' 'MET' 'HB2' 'HA' 0.100000 1.00800
10 ' ' '1' 'MET' 'CG' 'CT' -0.115000 12.0110
11 ' ' '1' 'MET' 'HG1' 'HA' 0.100000 1.00800
12 ' ' '1' 'MET' 'HG2' 'HA' 0.100000 1.00800
13 ' ' '1' 'MET' 'SD' 'S' -0.170000 32.0600
14 ' ' '1' 'MET' 'CE' 'CT' -0.215000 12.0110
15 ' ' '1' 'MET' 'HE1' 'HA' 0.100000 1.00800
16 ' ' '1' 'MET' 'HE2' 'HA' 0.100000 1.00800
17 ' ' '1' 'MET' 'HE3' 'HA' 0.100000 1.00800
18 ' ' '1' 'MET' 'C' 'C' 0.480000 12.0110
19 ' ' '1' 'MET' 'O' 'O' -0.480000 15.9990
20 ' ' '2' 'VAL' 'N' 'NH1' -0.360000 14.0070
21 ' ' '2' 'VAL' 'HN' 'H' 0.260000 1.00800
22 ' ' '2' 'VAL' 'CA' 'CT' 0.000000E+00 12.0110
23 ' ' '2' 'VAL' 'HA' 'HA' 0.100000 1.00800
24 ' ' '2' 'VAL' 'CB' 'CT' -0.100000 12.0110
25 ' ' '2' 'VAL' 'HB' 'HA' 0.100000 1.00800
26 ' ' '2' 'VAL' 'CG1' 'CT' -0.300000 12.0110
27 ' ' '2' 'VAL' 'HG11' 'HA' 0.100000 1.00800
28 ' ' '2' 'VAL' 'HG12' 'HA' 0.100000 1.00800
29 ' ' '2' 'VAL' 'HG13' 'HA' 0.100000 1.00800
30 ' ' '2' 'VAL' 'CG2' 'CT' -0.300000 12.0110
31 ' ' '2' 'VAL' 'HG21' 'HA' 0.100000 1.00800
32 ' ' '2' 'VAL' 'HG22' 'HA' 0.100000 1.00800
33 ' ' '2' 'VAL' 'HG23' 'HA' 0.100000 1.00800
34 ' ' '2' 'VAL' 'C' 'C' 0.480000 12.0110
35 ' ' '2' 'VAL' 'O' 'O' -0.480000 15.9990
36 ' ' '3' 'LYS' 'N' 'NH1' -0.360000 14.0070
37 ' ' '3' 'LYS' 'HN' 'H' 0.260000 1.00800
38 ' ' '3' 'LYS' 'CA' 'CT' 0.000000E+00 12.0110
39 ' ' '3' 'LYS' 'HA' 'HA' 0.100000 1.00800
40 ' ' '3' 'LYS' 'CB' 'CT' -0.200000 12.0110
41 ' ' '3' 'LYS' 'HB1' 'HA' 0.100000 1.00800
42 ' ' '3' 'LYS' 'HB2' 'HA' 0.100000 1.00800
43 ' ' '3' 'LYS' 'CG' 'CT' -0.200000 12.0110
44 ' ' '3' 'LYS' 'HG1' 'HA' 0.100000 1.00800
45 ' ' '3' 'LYS' 'HG2' 'HA' 0.100000 1.00800
46 ' ' '3' 'LYS' 'CD' 'CT' -0.200000 12.0110
47 ' ' '3' 'LYS' 'HD1' 'HA' 0.100000 1.00800
48 ' ' '3' 'LYS' 'HD2' 'HA' 0.100000 1.00800
49 ' ' '3' 'LYS' 'CE' 'CT' 0.305000 12.0110
50 ' ' '3' 'LYS' 'HE1' 'HA' 0.100000 1.00800
51 ' ' '3' 'LYS' 'HE2' 'HA' 0.100000 1.00800
52 ' ' '3' 'LYS' 'NZ' 'NH3' -0.810000 14.0070
53 ' ' '3' 'LYS' 'HZ1' 'HC' 0.435000 1.00800
54 ' ' '3' 'LYS' 'HZ2' 'HC' 0.435000 1.00800
55 ' ' '3' 'LYS' 'HZ3' 'HC' 0.435000 1.00800
56 ' ' '3' 'LYS' 'C' 'C' 0.480000 12.0110
57 ' ' '3' 'LYS' 'O' 'O' -0.480000 15.9990
58 ' ' '4' 'GLN' 'N' 'NH1' -0.360000 14.0070
59 ' ' '4' 'GLN' 'HN' 'H' 0.260000 1.00800
60 ' ' '4' 'GLN' 'CA' 'CT' 0.000000E+00 12.0110
61 ' ' '4' 'GLN' 'HA' 'HA' 0.100000 1.00800
62 ' ' '4' 'GLN' 'CB' 'CT' -0.200000 12.0110
63 ' ' '4' 'GLN' 'HB1' 'HA' 0.100000 1.00800
64 ' ' '4' 'GLN' 'HB2' 'HA' 0.100000 1.00800
65 ' ' '4' 'GLN' 'CG' 'CT' -0.200000 12.0110
66 ' ' '4' 'GLN' 'HG1' 'HA' 0.100000 1.00800
67 ' ' '4' 'GLN' 'HG2' 'HA' 0.100000 1.00800
68 ' ' '4' 'GLN' 'CD' 'C' 0.480000 12.0110
69 ' ' '4' 'GLN' 'OE1' 'O' -0.480000 15.9990
70 ' ' '4' 'GLN' 'NE2' 'NH2' -0.520000 14.0070
71 ' ' '4' 'GLN' 'HE21' 'H' 0.260000 1.00800
72 ' ' '4' 'GLN' 'HE22' 'H' 0.260000 1.00800
73 ' ' '4' 'GLN' 'C' 'C' 0.480000 12.0110
74 ' ' '4' 'GLN' 'O' 'O' -0.480000 15.9990
-1 ' ' ' ' ' ' ' ' ' ' -1.00000 -1.00000

loop_
_cns_mtf_bond.id[1]
_cns_mtf_bond.id[2]
1 5
5 6
5 7
7 8
7 9
7 10
10 11
10 12
10 13
13 14
14 15
14 16
14 17
5 18
18 19
2 1
3 1
4 1
20 21
20 22
22 23
22 24
24 25
24 26
26 27
26 28
26 29
24 30
30 31
30 32
30 33
22 34
34 35
18 20
36 37
36 38
38 39
38 40
40 41
40 42
40 43
43 44
43 45
43 46
46 47
46 48
46 49
49 50
49 51
49 52
52 53
52 54
52 55
38 56
56 57
34 36
58 59
58 60
60 61
60 62
62 63
62 64
62 65
65 66
65 67
65 68
68 69
68 70
70 71
70 72
60 73
73 74
56 58
-1 -1

loop_
_cns_mtf_angle.id[1]
_cns_mtf_angle.id[2]
_cns_mtf_angle.id[3]
1 5 6
1 5 7
1 5 18
6 5 7
6 5 18
5 7 8
5 7 9
5 7 10
7 5 18
8 7 9
8 7 10
9 7 10
7 10 11
7 10 12
7 10 13
11 10 12
11 10 13
12 10 13
10 13 14
13 14 15
13 14 16
13 14 17
15 14 16
15 14 17
16 14 17
5 18 19
2 1 3
3 1 4
3 1 5
2 1 4
2 1 5
4 1 5
21 20 22
20 22 23
20 22 24
20 22 34
23 22 24
23 22 34
22 24 25
22 24 26
22 24 30
24 22 34
25 24 26
25 24 30
24 26 27
24 26 28
24 26 29
26 24 30
27 26 28
27 26 29
28 26 29
24 30 31
24 30 32
24 30 33
31 30 32
31 30 33
32 30 33
22 34 35
5 18 20
19 18 20
18 20 22
18 20 21
37 36 38
36 38 39
36 38 40
36 38 56
39 38 40
39 38 56
38 40 41
38 40 42
38 40 43
40 38 56
41 40 42
41 40 43
42 40 43
40 43 44
40 43 45
40 43 46
44 43 45
44 43 46
45 43 46
43 46 47
43 46 48
43 46 49
47 46 48
47 46 49
48 46 49
46 49 50
46 49 51
46 49 52
50 49 51
50 49 52
51 49 52
49 52 53
49 52 54
49 52 55
53 52 54
53 52 55
54 52 55
38 56 57
22 34 36
35 34 36
34 36 38
34 36 37
59 58 60
58 60 61
58 60 62
58 60 73
61 60 62
61 60 73
60 62 63
60 62 64
60 62 65
62 60 73
63 62 64
63 62 65
64 62 65
62 65 66
62 65 67
62 65 68
66 65 67
66 65 68
67 65 68
65 68 69
65 68 70
69 68 70
68 70 71
68 70 72
71 70 72
60 73 74
38 56 58
57 56 58
56 58 60
56 58 59
-1 -1 -1

loop_
_cns_mtf_dihedral.id[1]
_cns_mtf_dihedral.id[2]
_cns_mtf_dihedral.id[3]
_cns_mtf_dihedral.id[4]
10 7 5 1
13 10 7 5
14 13 10 7
26 24 22 20
43 40 38 36
46 43 40 38
49 46 43 40
52 49 46 43
65 62 60 58
68 65 62 60
69 68 65 62
-1 -1 -1 -1

loop_
_cns_mtf_improper.id[1]
_cns_mtf_improper.id[2]
_cns_mtf_improper.id[3]
_cns_mtf_improper.id[4]
6 1 18 7
8 9 5 10
11 12 7 13
15 16 13 17
2 3 5 4
23 20 34 24
25 22 26 30
27 28 24 29
31 32 24 33
19 18 20 22
21 20 18 5
5 18 20 22
39 36 56 40
41 42 38 43
44 45 40 46
47 48 43 49
50 51 46 52
53 54 49 55
35 34 36 38
37 36 34 22
22 34 36 38
61 58 73 62
68 65 69 70
70 68 71 72
65 68 70 71
63 64 60 65
66 67 62 68
57 56 58 60
59 58 56 38
38 56 58 60
-1 -1 -1 -1

loop_
_cns_mtf_explicit_nonbonded_exclusion.inb
31
32
33
31
32
33
31
32
33
27
28
29
27
28
29
27
28
29
-1

loop_
_cns_mtf_explicit_nonbonded_exclusion.iblo
0
0
0
0
0
0
0
0
0
0
0
0
0
0
0
0
0
0
0
0
0
0
0
0
0
0
3
6
9
9
12
15
18
18
18
18
18
18
18
18
18
18
18
18
18
18
18
18
18
18
18
18
18
18
18
18
18
18
18
18
18
18
18
18
18
18
18
18
18
18
18
18
18
18
-1

loop_
_cns_mtf_group_linked_list.first_atom_id
0
4
6
9
12
13
17
19
21
23
25
29
33
35
37
39
42
45
48
51
55
57
59
61
64
67
69
72
-1

end
coor
ATOM      1  N   MET     1      -8.549  -2.707   9.520  1.00  0.73          
ATOM      2  HT1 MET     1      -9.495  -2.716   9.949  1.00  1.32          
ATOM      3  HT2 MET     1      -8.047  -3.585   9.766  1.00  1.38          
ATOM      4  HT3 MET     1      -8.641  -2.636   8.486  1.00  1.18          
ATOM      5  CA  MET     1      -7.780  -1.538  10.032  1.00  0.31          
ATOM      6  HA  MET     1      -8.377  -0.644   9.944  1.00  0.43          
ATOM      7  CB  MET     1      -7.416  -1.780  11.501  1.00  0.70          
ATOM      8  HB1 MET     1      -6.833  -0.951  11.869  1.00  1.24          
ATOM      9  HB2 MET     1      -6.839  -2.689  11.582  1.00  1.07          
ATOM     10  CG  MET     1      -8.692  -1.909  12.337  1.00  1.55          
ATOM     11  HG1 MET     1      -8.429  -2.150  13.356  1.00  2.18          
ATOM     12  HG2 MET     1      -9.312  -2.696  11.930  1.00  2.10          
ATOM     13  SD  MET     1      -9.604  -0.345  12.305  1.00  2.25          
ATOM     14  CE  MET     1     -11.002  -0.877  13.326  1.00  2.89          
ATOM     15  HE1 MET     1     -10.689  -0.937  14.360  1.00  3.14          
ATOM     16  HE2 MET     1     -11.341  -1.846  12.999  1.00  3.19          
ATOM     17  HE3 MET     1     -11.808  -0.165  13.230  1.00  3.38          
ATOM     18  C   MET     1      -6.501  -1.386   9.204  1.00  0.24          
ATOM     19  O   MET     1      -6.507  -1.576   8.004  1.00  0.21          
ATOM     20  N   VAL     2      -5.403  -1.057   9.841  1.00  0.24          
ATOM     21  HN  VAL     2      -5.428  -0.920  10.809  1.00  0.30          
ATOM     22  CA  VAL     2      -4.105  -0.899   9.111  1.00  0.19          
ATOM     23  HA  VAL     2      -4.245  -1.068   8.050  1.00  0.17          
ATOM     24  CB  VAL     2      -3.560   0.515   9.331  1.00  0.20          
ATOM     25  HB  VAL     2      -3.509   0.722  10.390  1.00  0.25          
ATOM     26  CG1 VAL     2      -2.158   0.620   8.723  1.00  0.18          
ATOM     27 HG11 VAL     2      -1.873   1.659   8.649  1.00  1.03          
ATOM     28 HG12 VAL     2      -2.157   0.174   7.740  1.00  1.00          
ATOM     29 HG13 VAL     2      -1.454   0.097   9.354  1.00  1.01          
ATOM     30  CG2 VAL     2      -4.483   1.531   8.652  1.00  0.30          
ATOM     31 HG21 VAL     2      -4.458   1.383   7.582  1.00  1.08          
ATOM     32 HG22 VAL     2      -4.149   2.531   8.885  1.00  1.01          
ATOM     33 HG23 VAL     2      -5.493   1.396   9.011  1.00  1.10          
ATOM     34  C   VAL     2      -3.099  -1.916   9.655  1.00  0.22          
ATOM     35  O   VAL     2      -3.026  -2.153  10.843  1.00  0.28          
ATOM     36  N   LYS     3      -2.318  -2.511   8.786  1.00  0.18          
ATOM     37  HN  LYS     3      -2.398  -2.293   7.835  1.00  0.14          
ATOM     38  CA  LYS     3      -1.304  -3.519   9.225  1.00  0.22          
ATOM     39  HA  LYS     3      -1.221  -3.532  10.302  1.00  0.27          
ATOM     40  CB  LYS     3      -1.731  -4.904   8.710  1.00  0.26          
ATOM     41  HB1 LYS     3      -1.708  -4.901   7.630  1.00  0.24          
ATOM     42  HB2 LYS     3      -2.740  -5.110   9.038  1.00  0.32          
ATOM     43  CG  LYS     3      -0.785  -6.003   9.235  1.00  0.34          
ATOM     44  HG1 LYS     3       0.224  -5.626   9.285  1.00  0.87          
ATOM     45  HG2 LYS     3      -0.813  -6.849   8.565  1.00  0.97          
ATOM     46  CD  LYS     3      -1.226  -6.456  10.631  1.00  0.81          
ATOM     47  HD1 LYS     3      -2.219  -6.876  10.571  1.00  1.55          
ATOM     48  HD2 LYS     3      -1.234  -5.612  11.301  1.00  1.59          
ATOM     49  CE  LYS     3      -0.259  -7.518  11.159  1.00  1.37          
ATOM     50  HE1 LYS     3      -0.157  -8.307  10.428  1.00  1.99          
ATOM     51  HE2 LYS     3      -0.643  -7.927  12.083  1.00  1.96          
ATOM     52  NZ  LYS     3       1.073  -6.899  11.409  1.00  1.97          
ATOM     53  HZ1 LYS     3       1.700  -7.085  10.600  1.00  2.39          
ATOM     54  HZ2 LYS     3       1.488  -7.307  12.273  1.00  2.30          
ATOM     55  HZ3 LYS     3       0.963  -5.872  11.529  1.00  2.50          
ATOM     56  C   LYS     3       0.045  -3.149   8.607  1.00  0.16          
ATOM     57  O   LYS     3       0.147  -2.919   7.418  1.00  0.13          
ATOM     58  N   GLN     4       1.085  -3.095   9.402  1.00  0.18          
ATOM     59  HN  GLN     4       0.981  -3.290  10.356  1.00  0.21          
ATOM     60  CA  GLN     4       2.433  -2.745   8.856  1.00  0.15          
ATOM     61  HA  GLN     4       2.328  -2.176   7.942  1.00  0.13          
ATOM     62  CB  GLN     4       3.203  -1.911   9.888  1.00  0.20          
ATOM     63  HB1 GLN     4       3.366  -2.501  10.777  1.00  0.22          
ATOM     64  HB2 GLN     4       2.628  -1.032  10.141  1.00  0.24          
ATOM     65  CG  GLN     4       4.557  -1.488   9.305  1.00  0.21          
ATOM     66  HG1 GLN     4       4.404  -1.003   8.353  1.00  0.21          
ATOM     67  HG2 GLN     4       5.179  -2.365   9.169  1.00  0.19          
ATOM     68  CD  GLN     4       5.250  -0.519  10.266  1.00  0.27          
ATOM     69  OE1 GLN     4       4.631   0.006  11.169  1.00  0.81          
ATOM     70  NE2 GLN     4       6.518  -0.249  10.104  1.00  0.98          
ATOM     71 HE21 GLN     4       7.018  -0.667   9.372  1.00  1.61          
ATOM     72 HE22 GLN     4       6.968   0.374  10.714  1.00  1.01          
ATOM     73  C   GLN     4       3.201  -4.033   8.575  1.00  0.13          
ATOM     74  O   GLN     4       3.400  -4.848   9.452  1.00  0.14          
END


evaluate ($kprot = 0.1)     !proton shifts

!
! Protons_setup.tbl
!
! Setup for proton chemical shift refinement 
! 
! starts by doing selections for electric field stuff,
! then magnetic anisotropy,
! then ring currents,
! and finally random coil shifts.
!
! Random coil shifts are from Williamson's file random.dat
!
! by John Kuszewski Dec 1994
!

set message off echo off end


!
! select all the alpha and amide protons, the amides alone,
! the carbons, the nitrogens, and the oxygens
!

prot

     alphasandamides (name ha or name hn)

     amides (name hn)

     carbons (name c)

     nitrogens (name n)

     oxygens (name o)

end

!
! set up the CaC=O bonds from the backbone
! produces an error on the last time through
!

for $count in id (name ca) loop anis
     identify (store1) ((byresidue id $count) and (name ca))
     identify (store2) ((byresidue id $count) and (name c))
     identify (store3) ((byresidue id $count) and (name o))
     prot anis (store1) (store2) (store3) CO notCOOH BB end
end loop anis

!
! set up the backbone C-N bonds
! (apparently, sidechain C-N bonds are ignored)
! produces an error on the last time through
!
!
! need a loop that goes thru all residues except the first one,
! getting the current residue's O and C atoms and the next residue's
! N atom into store1, 2, and 3, respectively.
!

for $count in id (name ca) loop anis
    show elem (segid) (id $count)
    eval ($curseg = $result)
    show elem (resid) (id $count)
    eval ($curres = $result)
    eval ($nextres = decode($curres) + 1)
    do (store9 = 1) (all)
   show sum (store9)((resid $nextres) and (segid $curseg) and (name n))
    if ($result # 0) then
        identify (store1) ((byresidue id $count) and (name o))
        identify (store2) ((byresidue id $count) and (name c))
        identify (store3) ((resid $nextres) and (segid $curseg) 
                                                   and (name n))
        prot anis (store1) (store2) (store3) CN notCOOH BB end
    end if
end loop anis

!
! set up the CC=O bonds for the sidechains
!

for $count in id (name ca and resn asp) loop anis
     identify (store1) ((byresidue id $count) and (name cb))
     identify (store2) ((byresidue id $count) and (name cg))
     identify (store3) ((byresidue id $count) and (name od1))
     identify (store4) ((byresidue id $count) and (name od2))
     prot anis (store1) (store2) (store3) CO COOH SC end
     prot anis (store1) (store2) (store4) CO COOH SC end
end loop anis

for $count in id (name ca and resn glu) loop anis
     identify (store1) ((byresidue id $count) and (name cg))
     identify (store2) ((byresidue id $count) and (name cd))
     identify (store3) ((byresidue id $count) and (name oe1))
     identify (store4) ((byresidue id $count) and (name oe2))
     prot anis (store1) (store2) (store3) CO COOH SC end
     prot anis (store1) (store2) (store4) CO COOH SC end
end loop anis

for $count in id (name ca and resn asn) loop anis
     identify (store1) ((byresidue id $count) and (name cb))
     identify (store2) ((byresidue id $count) and (name cg))
     identify (store3) ((byresidue id $count) and (name od1))
     prot anis (store1) (store2) (store3) CO notCOOH SC end
end loop anis

for $count in id (name ca and resn gln) loop anis
     identify (store1) ((byresidue id $count) and (name cg))
     identify (store2) ((byresidue id $count) and (name cd))
     identify (store3) ((byresidue id $count) and (name oe1))
     prot anis (store1) (store2) (store3) CO notCOOH SC end
end loop anis

!
! handle the rings
!

for $count in id (name ca and resn phe) loop ring
     identify (store1) ((byresidue id $count) and (name cg))
     identify (store2) ((byresidue id $count) and (name cd1))
     identify (store3) ((byresidue id $count) and (name ce1))
     identify (store4) ((byresidue id $count) and (name cz))
     identify (store5) ((byresidue id $count) and (name ce2))
     identify (store6) ((byresidue id $count) and (name cd2))
     prot ring PHE (store1) (store2) (store3) (store4) (store5) (store6) end
end loop ring

for $count in id (name ca and resn tyr) loop ring
     identify (store1) ((byresidue id $count) and (name cg))
     identify (store2) ((byresidue id $count) and (name cd1))
     identify (store3) ((byresidue id $count) and (name ce1))
     identify (store4) ((byresidue id $count) and (name cz))
     identify (store5) ((byresidue id $count) and (name ce2))
     identify (store6) ((byresidue id $count) and (name cd2))
     prot ring TYR (store1) (store2) (store3) (store4) (store5) (store6) end
end loop ring

for $count in id (name ca and resn trp) loop ring
     identify (store1) ((byresidue id $count) and (name ce2))
     identify (store2) ((byresidue id $count) and (name cd2))
     identify (store3) ((byresidue id $count) and (name ce3))
     identify (store4) ((byresidue id $count) and (name cz3))
     identify (store5) ((byresidue id $count) and (name ch2))
     identify (store6) ((byresidue id $count) and (name cz2))
     prot ring TRP6 (store1) (store2) (store3) (store4) (store5) (store6) end
end loop ring

for $count in id (name ca and resn his) loop ring
     identify (store1) ((byresidue id $count) and (name cg))
     identify (store2) ((byresidue id $count) and (name cd2))
     identify (store3) ((byresidue id $count) and (name ne2))
     identify (store4) ((byresidue id $count) and (name ce1))
     identify (store5) ((byresidue id $count) and (name nd1))
     prot ring HIS (store1) (store2) (store3) (store4) (store5) end
end loop ring

for $count in id (name ca and resn trp) loop ring
     identify (store1) ((byresidue id $count) and (name cg))
     identify (store2) ((byresidue id $count) and (name cd1))
     identify (store3) ((byresidue id $count) and (name ne1))
     identify (store4) ((byresidue id $count) and (name ce2))
     identify (store5) ((byresidue id $count) and (name cd2))
     prot ring TRP5 (store1) (store2) (store3) (store4) (store5) end
end loop ring

!
! this holds the random coil proton chemical shifts
! from the file random.dat provided with Williamson's
! proton shift program, with his secondary corrections
! of -0.65 ppm to each Ha, -0.20 ppm to each HN, +0.22 ppm
! to each gly Ha*, and a change to 4.45 ppm for each 
! Ha of YFWH.  Original values with the noted changes 
! are commented out.
!

prot

rcoil (hydrogen) 0.00

!rcoil (resn GLY and name HN) 8.39 - 0.20
!rcoil (resn GLY and name HA1) 3.97 - 0.65 + 0.22
!rcoil (resn GLY and name HA2) 3.97 - 0.65 + 0.22

rcoil (resn GLY and name HN) 8.19
rcoil (resn GLY and name HA1) 3.54
rcoil (resn GLY and name HA2) 3.54

!rcoil (resn ALA and name HN) 8.25 - 0.20
!rcoil (resn ALA and name HA) 4.35 - 0.65

rcoil (resn ALA and name HN) 8.05
rcoil (resn ALA and name HA) 3.70
rcoil (resn ALA and name HB1) 1.40
rcoil (resn ALA and name HB2) 1.40
rcoil (resn ALA and name HB3) 1.40

!rcoil (resn VAL and name HN) 8.44 - 0.20
!rcoil (resn VAL and name HA) 4.18 - 0.65

rcoil (resn VAL and name HN) 8.24
rcoil (resn VAL and name HA) 3.53
rcoil (resn VAL and name HB) 2.13
rcoil (resn VAL and name HG11) 0.96
rcoil (resn VAL and name HG12) 0.96
rcoil (resn VAL and name HG13) 0.96
rcoil (resn VAL and name HG21) 0.96
rcoil (resn VAL and name HG22) 0.96
rcoil (resn VAL and name HG23) 0.96

!rcoil (resn ILE and name HN) 8.20 - 0.20
!rcoil (resn ILE and name HA) 4.22 - 0.65

rcoil (resn ILE and name HN) 8.00
rcoil (resn ILE and name HA) 3.57
rcoil (resn ILE and name HB) 1.89
rcoil (resn ILE and name HG21) 0.94
rcoil (resn ILE and name HG22) 0.94
rcoil (resn ILE and name HG23) 0.94
rcoil (resn ILE and name HG11) 1.30
rcoil (resn ILE and name HG12) 1.30
rcoil (resn ILE and name HD11) 0.89
rcoil (resn ILE and name HD12) 0.89
rcoil (resn ILE and name HD13) 0.89

!rcoil (resn LEU and name HN) 8.42 - 0.20
!rcoil (resn LEU and name HA) 4.39 - 0.65

rcoil (resn LEU and name HN) 8.02
rcoil (resn LEU and name HA) 3.74
rcoil (resn LEU and name HB1) 1.65
rcoil (resn LEU and name HB2) 1.65
rcoil (resn LEU and name HG) 1.65
rcoil (resn LEU and name HD11) 0.92
rcoil (resn LEU and name HD12) 0.92
rcoil (resn LEU and name HD13) 0.92
rcoil (resn LEU and name HD21) 0.92
rcoil (resn LEU and name HD22) 0.92
rcoil (resn LEU and name HD23) 0.92

!rcoil (resn SER and name HN) 8.38 - 0.20
!rcoil (resn SER and name HA) 4.50 - 0.65

rcoil (resn SER and name HN) 8.18
rcoil (resn SER and name HA) 3.85
rcoil (resn SER and name HB1) 3.89
rcoil (resn SER and name HB2) 3.89
! no HG?

!rcoil (resn THR and name HN) 8.24 - 0.20
!rcoil (resn THR and name HA) 4.35 - 0.65

rcoil (resn THR and name HN) 8.04
rcoil (resn THR and name HA) 3.70
rcoil (resn THR and name HB) 4.22
rcoil (resn THR and name HG21) 1.23
rcoil (resn THR and name HG22) 1.23
rcoil (resn THR and name HG23) 1.23

!rcoil (resn ASP and name HN) 8.41 - 0.20
!rcoil (resn ASP and name HA) 4.77 - 0.65

rcoil (resn ASP and name HN) 8.21
rcoil (resn ASP and name HA) 4.12
rcoil (resn ASP and name HB1) 2.80
rcoil (resn ASP and name HB2) 2.80

!rcoil (resn GLU and name HN) 8.37 - 0.20
!rcoil (resn GLU and name HA) 4.30 - 0.65

rcoil (resn GLU and name HN) 8.17
rcoil (resn GLU and name HA) 3.65
rcoil (resn GLU and name HB1) 2.03
rcoil (resn GLU and name HB2) 2.03
rcoil (resn GLU and name HG1) 2.30
rcoil (resn GLU and name HG2) 2.30

!rcoil (resn LYS and name HN) 8.41 - 0.20
!rcoil (resn LYS and name HA) 4.36 - 0.65

rcoil (resn LYS and name HN) 8.21
rcoil (resn LYS and name HA) 3.71
rcoil (resn LYS and name HB1) 1.81
rcoil (resn LYS and name HB2) 1.81
rcoil (resn LYS and name HG1) 1.47
rcoil (resn LYS and name HG2) 1.47
rcoil (resn LYS and name HD1) 1.71
rcoil (resn LYS and name HD2) 1.71
rcoil (resn LYS and name HE1) 3.02
rcoil (resn LYS and name HE2) 3.02
! no HZ?

!rcoil (resn ARG and name HN) 8.27 - 0.20
!rcoil (resn ARG and name HA) 4.40 - 0.65

rcoil (resn ARG and name HN) 8.07
rcoil (resn ARG and name HA) 3.75
rcoil (resn ARG and name HB1) 1.85
rcoil (resn ARG and name HB2) 1.85
rcoil (resn ARG and name HG1) 1.72
rcoil (resn ARG and name HG2) 1.72
rcoil (resn ARG and name HD1) 3.31
rcoil (resn ARG and name HD2) 3.31
! no HE, HZ?

!rcoil (resn ASN and name HN) 8.75 - 0.20
!rcoil (resn ASN and name HA) 4.76 - 0.65

rcoil (resn ASN and name HN) 8.55
rcoil (resn ASN and name HA) 4.11
rcoil (resn ASN and name HB1) 2.80
rcoil (resn ASN and name HB2) 2.80
! no HD?

!rcoil (resn GLN and name HN) 8.41 - 0.20
!rcoil (resn GLN and name HA) 4.37 - 0.65

rcoil (resn GLN and name HN) 8.21
rcoil (resn GLN and name HA) 3.72
rcoil (resn GLN and name HB1) 2.08
rcoil (resn GLN and name HB2) 2.08
rcoil (resn GLN and name HG1) 2.38
rcoil (resn GLN and name HG2) 2.38
! no HE?

!rcoil (resn MET and name HN) 8.42 - 0.20
!rcoil (resn MET and name HA) 4.51 - 0.65

rcoil (resn MET and name HN) 8.22
rcoil (resn MET and name HA) 3.86
rcoil (resn MET and name HB1) 2.08
rcoil (resn MET and name HB2) 2.08
rcoil (resn MET and name HG1) 2.63
rcoil (resn MET and name HG2) 2.63
rcoil (resn MET and name HE1) 2.13
rcoil (resn MET and name HE2) 2.13
rcoil (resn MET and name HE3) 2.13

!rcoil (resn CYS and name HN) 8.31 - 0.20
!rcoil (resn CYS and name HA) 4.69 - 0.65

rcoil (resn CYS and name HN) 8.11
rcoil (resn CYS and name HA) 4.04
rcoil (resn CYS and name HB1) 3.16
rcoil (resn CYS and name HB2) 3.16
! no HG?

!rcoil (resn TRP and name HN) 8.09 - 0.20
!rcoil (resn TRP and name HA) 4.70 - 0.65 4.45

rcoil (resn TRP and name HN) 7.89
rcoil (resn TRP and name HA) 4.45
rcoil (resn TRP and name HB1) 3.26
rcoil (resn TRP and name HB2) 3.26
rcoil (resn TRP and name HE1) 9.99
rcoil (resn TRP and name HD1) 7.24
rcoil (resn TRP and name HE3) 7.65
rcoil (resn TRP and name HZ3) 7.17
rcoil (resn TRP and name HH2) 7.24
rcoil (resn TRP and name HZ2) 7.50

!rcoil (resn PHE and name HN) 8.23 - 0.20
!rcoil (resn PHE and name HA) 4.66 - 0.65 4.45

rcoil (resn PHE and name HN) 8.03
rcoil (resn PHE and name HA) 4.45
rcoil (resn PHE and name HB1) 3.11
rcoil (resn PHE and name HB2) 3.11
rcoil (resn PHE and name HD1) 7.34
rcoil (resn PHE and name HD2) 7.34
rcoil (resn PHE and name HE1) 7.34
rcoil (resn PHE and name HE2) 7.34
rcoil (resn PHE and name HZ) 7.34

!rcoil (resn TYR and name HN) 8.18 - 0.20
!rcoil (resn TYR and name HA) 4.60 - 0.65 4.45

rcoil (resn TYR and name HN) 7.98
rcoil (resn TYR and name HA) 4.45
rcoil (resn TYR and name HB1) 3.02
rcoil (resn TYR and name HB2) 3.02
rcoil (resn TYR and name HD1) 7.15
rcoil (resn TYR and name HD2) 7.15
rcoil (resn TYR and name HE1) 6.86
rcoil (resn TYR and name HE2) 6.86
! no HH?

!rcoil (resn HIS and name HN) 8.42 - 0.20
!rcoil (resn HIS and name HA) 4.63 - 0.65 4.45

rcoil (resn HIS and name HN) 8.22
rcoil (resn HIS and name HA) 4.45
rcoil (resn HIS and name HB1) 3.23
rcoil (resn HIS and name HB2) 3.23
rcoil (resn HIS and name HE1) 8.12
rcoil (resn HIS and name HD2) 7.14
! changed prev line to HD2 from HD1 (HD1 is exchangable) JK 1/6/95
! no HD2?

!rcoil (resn PRO and name HA) 4.47 - 0.65

rcoil (resn PRO and name HA) 3.82
rcoil (resn PRO and name HB1) 2.16
rcoil (resn PRO and name HB2) 2.16
rcoil (resn PRO and name HG1) 2.03
rcoil (resn PRO and name HG2) 2.03
rcoil (resn PRO and name HD1) 3.65
rcoil (resn PRO and name HD2) 3.65

end
set message on echo on end

protons
     potential harmonic
     class alpha
     force $kprot
     potential harmonic
     error 0.3
     OBSE (resid 3 and (name HA)) 4.53 
     OBSE (resid 4 and (name HA)) 4.76 
     class methyl
     force $kprot
     potential harm
     error 0.3
     OBSE (resid 2 and (name HG1#)) 0.86 
     OBSE (resid 2 and (name HG2#)) 0.7 
     class other
     force $kprot
     potential harm
     error 0.3
     OBSE (resid 1 and (name HB#)) 2.16 
     OBSE (resid 1 and (name HG#)) 2.58 
     OBSE (resid 2 and (name HB)) 1.95 
     OBSE (resid 3 and (name HB1)) 1.84 
     OBSE (resid 3 and (name HB2)) 1.77 
     OBSE (resid 3 and (name HG#)) 1.36 
     OBSE (resid 3 and (name HD#)) 1.68 
     OBSE (resid 3 and (name HE#)) 2.96 
     OBSE (resid 4 and (name HB#)) 2.02 
     OBSE (resid 4 and (name HG#)) 2.29 
end


prot print threshold 0.1 all normsd end
evaluate ($sprms = $rms)
evaluate ($spviols = $violations)

prot print threshold 0.1 class methyl normsd end
evaluate ($b_methyl_rms = $rms)
evaluate ($b_methyl_viols = $violations)

prot print threshold 0.1 class alpha normsd end
evaluate ($b_alpha_rms = $rms)
evaluate ($b_alpha_viols = $violations)

prot print threshold 0.1 class other normsd end
evaluate ($b_other_rms = $rms)
evaluate ($b_other_viols = $violations)

flag exclude * include prot end

minimize powells nstep=10 npri=2 end

prot print threshold 0.1 all normsd end
evaluate ($esprms = $rms)
evaluate ($espviols = $violations)

prot print threshold 0.1 class methyl normsd end
evaluate ($eb_methyl_rms = $rms)
evaluate ($eb_methyl_viols = $violations)

prot print threshold 0.1 class alpha normsd end
evaluate ($eb_alpha_rms = $rms)
evaluate ($eb_alpha_viols = $violations)

prot print threshold 0.1 class other normsd end
evaluate ($eb_other_rms = $rms)
evaluate ($eb_other_viols = $violations)

display $sprms $spviols $b_methyl_rms $b_methyl_viols $b_alpha_rms $b_alpha_viols $b_other_rms $b_other_viols
display $esprms $espviols $eb_methyl_rms $eb_methyl_viols $eb_alpha_rms $eb_alpha_viols $eb_other_rms $eb_other_viols

stop



