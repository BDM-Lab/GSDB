remarks cormantes
remarks =========
remarks TEST of COoRdinatMANipulation AND
remarks Radius_of_GYRation commands
remarks


topology @CNS_TOPPAR:protein.top end
parameter @CNS_TOPPAR:protein.param end


segment
  name=m1
  chain
     @CNS_TOPPAR:protein.link
     sequence ARG PRO ASP PHE CYS LEU end
  end
end

segment
  name=m2
  chain
     @CNS_TOPPAR:protein.link
     sequence CYS end
  end
end


patch disu reference 1 ( atom m1 5 * ) reference 2 ( atom m2 1 * )  end

coor
ATOM      1  HT1 ARG     1    9999.0009999.0009999.000  1.00  0.00      M1  
ATOM      2  HT2 ARG     1    9999.0009999.0009999.000  1.00  0.00      M1  
ATOM      3  N   ARG     1      26.521  27.417  -2.687  1.00  0.00      M1  
ATOM      4  HT3 ARG     1    9999.0009999.0009999.000  1.00  0.00      M1  
ATOM      5  CA  ARG     1      25.603  26.909  -1.661  1.00  0.00      M1  
ATOM      6  CB  ARG     1      24.610  25.885  -2.248  1.00  0.00      M1  
ATOM      7  CG  ARG     1      25.171  24.458  -2.379  1.00  0.00      M1  
ATOM      8  CD  ARG     1      24.124  23.541  -2.979  1.00  0.00      M1  
ATOM      9  NE  ARG     1      23.644  24.058  -4.269  1.00  0.00      M1  
ATOM     10  HE  ARG     1    9999.0009999.0009999.000  1.00  0.00      M1  
ATOM     11  CZ  ARG     1      24.299  23.863  -5.432  1.00  0.00      M1  
ATOM     12  NH1 ARG     1      25.434  23.152  -5.473  1.00  0.00      M1  
ATOM     13 HH11 ARG     1    9999.0009999.0009999.000  1.00  0.00      M1  
ATOM     14 HH12 ARG     1    9999.0009999.0009999.000  1.00  0.00      M1  
ATOM     15  NH2 ARG     1      23.797  24.379  -6.539  1.00  0.00      M1  
ATOM     16 HH21 ARG     1    9999.0009999.0009999.000  1.00  0.00      M1  
ATOM     17 HH22 ARG     1    9999.0009999.0009999.000  1.00  0.00      M1  
ATOM     18  C   ARG     1      26.256  26.217  -0.466  1.00  0.00      M1  
ATOM     19  O   ARG     1      27.268  25.519  -0.612  1.00  0.00      M1  
ATOM     20  N   PRO     2      25.669  26.420   0.698  1.00  0.00      M1  
ATOM     21  CD  PRO     2      24.639  27.414   0.964  1.00  0.00      M1  
ATOM     22  CA  PRO     2      26.191  25.807   1.926  1.00  0.00      M1  
ATOM     23  CB  PRO     2      25.364  26.408   3.014  1.00  0.00      M1  
ATOM     24  CG  PRO     2      24.531  27.554   2.480  1.00  0.00      M1  
ATOM     25  C   PRO     2      26.248  24.283   1.838  1.00  0.00      M1  
ATOM     26  O   PRO     2      25.462  23.661   1.112  1.00  0.00      M1  
ATOM     27  N   ASP     3      27.177  23.707   2.577  1.00  0.00      M1  
ATOM     28  H   ASP     3    9999.0009999.0009999.000  1.00  0.00      M1  
ATOM     29  CA  ASP     3      27.299  22.245   2.632  1.00  0.00      M1  
ATOM     30  CB  ASP     3      28.503  21.852   3.505  1.00  0.00      M1  
ATOM     31  CG  ASP     3      29.779  21.829   2.716  1.00  0.00      M1  
ATOM     32  OD1 ASP     3      29.879  22.171   1.551  1.00  0.00      M1  
ATOM     33  OD2 ASP     3      30.759  21.495   3.319  1.00  0.00      M1  
ATOM     34  C   ASP     3      26.084  21.485   3.155  1.00  0.00      M1  
ATOM     35  O   ASP     3      25.834  20.338   2.764  1.00  0.00      M1  
ATOM     36  N   PHE     4      25.348  22.133   4.032  1.00  0.00      M1  
ATOM     37  H   PHE     4    9999.0009999.0009999.000  1.00  0.00      M1  
ATOM     38  CA  PHE     4      24.187  21.495   4.664  1.00  0.00      M1  
ATOM     39  CB  PHE     4      23.774  22.291   5.885  1.00  0.00      M1  
ATOM     40  CG  PHE     4      23.261  23.671   5.594  1.00  0.00      M1  
ATOM     41  CD1 PHE     4      22.050  23.813   5.002  1.00  0.00      M1  
ATOM     42  CD2 PHE     4      23.943  24.792   5.980  1.00  0.00      M1  
ATOM     43  CE1 PHE     4      21.500  25.095   4.714  1.00  0.00      M1  
ATOM     44  CE2 PHE     4      23.360  26.080   5.725  1.00  0.00      M1  
ATOM     45  CZ  PHE     4      22.186  26.205   5.078  1.00  0.00      M1  
ATOM     46  C   PHE     4      23.006  21.365   3.706  1.00  0.00      M1  
ATOM     47  O   PHE     4      22.030  20.661   3.995  1.00  0.00      M1  
ATOM     48  N   CYS     5      23.111  22.047   2.589  1.00  0.00      M1  
ATOM     49  H   CYS     5    9999.0009999.0009999.000  1.00  0.00      M1  
ATOM     50  CA  CYS     5      22.174  21.827   1.482  1.00  0.00      M1  
ATOM     51  CB  CYS     5      22.342  22.861   0.400  1.00  0.00      M1  
ATOM     52  SG  CYS     5      22.120  24.593   0.905  1.00  0.00      M1  
ATOM     53  C   CYS     5      22.204  20.461   0.802  1.00  0.00      M1  
ATOM     54  O   CYS     5      21.259  20.083   0.099  1.00  0.00      M1  
ATOM     55  N   LEU     6      23.289  19.742   1.021  1.00  0.00      M1  
ATOM     56  H   LEU     6    9999.0009999.0009999.000  1.00  0.00      M1  
ATOM     57  CA  LEU     6      23.415  18.381   0.487  1.00  0.00      M1  
ATOM     58  CB  LEU     6      24.880  18.078   0.129  1.00  0.00      M1  
ATOM     59  CG  LEU     6      25.591  19.031  -0.805  1.00  0.00      M1  
ATOM     60  CD1 LEU     6      26.954  18.478  -1.142  1.00  0.00      M1  
ATOM     61  CD2 LEU     6      24.793  19.235  -2.068  1.00  0.00      M1  
ATOM     62  C   LEU     6      22.960  17.225   1.364  1.00  0.00      M1  
ATOM     63  O   LEU     6      22.954  16.068   0.927  1.00  0.00      M1  
ATOM     64  OXT LEU     6      22.589  17.547   2.588  1.00  0.00      M1  
ATOM     65  HT1 CYS     1    9999.0009999.0009999.000  1.00  0.00      M2  
ATOM     66  HT2 CYS     1    9999.0009999.0009999.000  1.00  0.00      M2  
ATOM     67  N   CYS     1      19.971  27.749  -0.850  1.00  0.00      M2  
ATOM     68  HT3 CYS     1    9999.0009999.0009999.000  1.00  0.00      M2  
ATOM     69  CA  CYS     1      20.614  26.605  -1.508  1.00  0.00      M2  
ATOM     70  CB  CYS     1      19.915  25.349  -1.035  1.00  0.00      M2  
ATOM     71  SG  CYS     1      20.136  24.920   0.720  1.00  0.00      M2  
ATOM     72  C   CYS     1      20.748  26.451  -3.024  1.00  0.00      M2  
ATOM     73  O   CYS     1      21.370  25.498  -3.515  1.00  0.00      M2  
ATOM     74  OXT CYS     1      20.162  27.391  -3.743  1.00  0.00      M2  
END




do ( store1 = mass ) ( all )
do ( mass =  1.0 )   ( all )
do ( mass =  10.0 )  ( name c* )


{* RGYR TESTS *}
coor rgyr mass=t selection=( not name h* ) end
do ( mass = recall1 ) ( all )
coor rgyr mass=t selection=( atom * * H* ) end
coor rgyr mass=t fact=1.5 selection=( not hydrogen ) end


coor copy sele=( not hydrogen ) end
coor init sele=( atom * * N* ) end
write coor sele=( known and not hydrogen ) end

coor swap sele=( not hydrogen) end
coor copy sele=( not hydrogen) end

coor translate vector=( 1.0,2.0,3.0 ) distance=10.0 end
coor rotate axis=( 3.0 2.0 1.0 ) 30.0    end
display  $theta1  $theta2 $theta3 
display  $rot_1_1, $rot_1_2, $rot_1_3
display  $rot_2_1, $rot_2_2, $rot_2_3
display  $rot_3_1, $rot_3_2, $rot_3_3
display  $axis_x, $axis_y, $axis_z $axis_kappa
display  $psi, $phi, $kappa
display  $q0, $q1, $q2, $q3

write coor sele=( bynumber 1:10 ) end

coor rms sele=( not hydrogen ) end
display  $result
coor rms sele=( not hydrogen ) end

do ( b=rmsd ) ( not hydrogen )
write coor sele=( name C ) end

coor orient sele=( known ) end
display  $theta1  $theta2 $theta3  $x $y $z
display  $rot_1_1, $rot_1_2, $rot_1_3
display  $rot_2_1, $rot_2_2, $rot_2_3
display  $rot_3_1, $rot_3_2, $rot_3_3
display  $axis_x, $axis_y, $axis_z $axis_kappa
display  $psi, $phi, $kappa
display  $q0, $q1, $q2, $q3


coor fit sele=( known ) end
display  $theta1  $theta2 $theta3  $x $y $z
display  $rot_1_1, $rot_1_2, $rot_1_3
display  $rot_2_1, $rot_2_2, $rot_2_3
display  $rot_3_1, $rot_3_2, $rot_3_3
display  $axis_x, $axis_y, $axis_z $axis_kappa
display  $psi, $phi, $kappa
display  $q0, $q1, $q2, $q3

parameter
   nbonds  
      nbxmod=1 wmin=0.1
   end 
end

igroup interaction=( known ) ( known ) end

distance
      from=( bynumber 5 : 6  ) to=( bynumber 7 : 8 ) disposition=print
      cutoff=999.0 cuton=0.0
end

distance
      from=( bynumber 5 : 6  ) to=( bynumber 7 : 8 ) disposition=rmsd
      cutoff=999.0 cuton=0.0
end
do ( b=rmsd ) ( all )

distance 
      from=( bynumber 5 : 6 ) to=( bynumber 7 : 8 ) disposition=matrix
end


write coor sele=( bynumber 1:10 ) end

coor rms sele=( known ) end
do ( b=rmsd ) ( known ) 

coor swap end
write coor sele=( bynumber 1:10 ) end

coor copy end

xray
  alpha=120.0 beta=90.0 gamma=90.0  a=1.0 b=2.0 c=1.0
end

coor fract end
write coor sele=( name C ) end

coor ortho end
coor rms end
do (b=rmsd) ( all )

{* test HEAD TAIL vector syntax *}
write coor selection=(atom M1 1 N  or atom M1 1 CA) end
coor translate vector=(HEAD=(atom M1 1 N) TAIL=(atom M1 1 CA)) end
write coor selection=(atom M1 1 N  or atom M1 1 CA) end

{* test new rotation options *}

coor swap end
coor copy end
write coor selection=( bynumber 1:10 ) end
coor rgyr mass=true end

coor rotate 
     euler=( 10.0 20.0 10.0 )
     center=( HEAD=( not hydrogen ) )
end
coor rotate 
     euler=( 30. 0. 0. )
end
coor rotate 
     euler=( 0. 25. 0. )
end
coor rotate 
     euler=( 0. 0. 30. )
end

coor rgyr mass=true end
write coor selection=( bynumber 1:10 ) end

coor rotate 
     spherical=( 10. 0. 0. ) 
end
coor rotate 
     spherical=( 0. 10. 0. ) 
end
coor rotate 
     spherical=( 0. 0. 10. ) 
end
coor rotate 
     spherical=( 90. 0. 10. ) 
end
coor rotate 
     spherical=( 180. 0. 10. ) 
end
coor rotate 
     sphercial=( 0. 90. 10. )
end
coor rotate 
     sphercial=( 90. 90. 10. )
end

write coor selection=( bynumber 1:10 ) end
coor fit end


coor rotate euler=( 40. 0. 30. ) end
coor rotate euler=( 220. 30. 260. ) end
coor rotate spherical=( 0. 30. 190. ) end
coor rotate spherical=( 220. 240. 80. ) end
coor rotate lattman=( 40. 50. 20. ) end
coor rotate lattman=( 400. 40. 200. ) end
coor rotate lattman=( 200. 40. 300. ) end

coor copy end

coor rotate euler=( 33. 41. 21. ) end
coor translate vector=( 3. 2. 1. ) end
do ( store1=x ) ( all )
do ( store2=y ) ( all )
do ( store3=z ) ( all )

coor fit sele=( known ) end

do ( x=store1 ) ( all )
do ( y=store2 ) ( all )
do ( z=store3 ) ( all )

coor rotate axis=( -0.6322   -0.0665   -0.7719 ) 66.8555 end
coor translate vector=( -0.8957   -2.4471   -2.6850) end
coor fit sele=( known ) end

do ( store1=x ) ( all )
do ( store2=y ) ( all )
do ( store3=z ) ( all )

coor orient end

do ( x=store1 ) ( all )
do ( y=store2 ) ( all )
do ( z=store3 ) ( all )
coor rotate axis=( 0.5668   -0.5486   -0.6147 ) 47.9362  end
coor translate vector=(    7.8772  -15.1329   28.8854) end
coor orient end


coor copy end

coor rotate 
   quaternions= 0.3 0.1 0.6 0.7  
end

coor fit  sele=( known ) end

coor rotate
    matrix=( 1. 2. 3. )
           ( 3. 4. 5. )
           ( 6. 7. 8. )
end

xray
    a=16.00 b=16.00 c=16.00 alpha=90.0 beta=90.00 gamma=90.0
  symmetry=( X,Y,Z )
  symmetry=( -X,-Y,1/2+Z )
  symmetry=( 1/2-Y,1/2+X,1/4+Z )
  symmetry=( 1/2+Y,1/2-X,3/4+Z )
  symmetry=( 1/2-X,1/2+Y,1/4-Z )
  symmetry=( 1/2+X,1/2-Y,3/4-Z )
  symmetry=( Y,X,-Z )
  symmetry=( -Y,-X,1/2-Z )
end

coor copy end
coor symmetry=(1/2+x,1/2-y,-z) end
coor swap end
coor fract end
coor rotate matrix=( 1 0 0 )
                   ( 0 -1 0 )
                   ( 0  0 -1)
end
coor translate vector=( 0.5 0.5 0. ) end
coor orth end
coor rms end

xray
    a=16.00 b=16.00 c=16.00 alpha=90.0 beta=120.00 gamma=90.0
end

coor copy end
coor symmetry=(-y,1/2+x,1/4+z) end
coor swap end
coor fract end
coor rotate matrix=( 0 -1 0)
                   ( 1 0 0 )
                   ( 0  0 1)
end
coor translate vector=( 0. 0.5 0.25  ) end
coor orth end
coor rms end

coor copy end
coor symmetry=(x,y,z) end
coor rms end



   
STOP
