remark
remark  TORSIONTEST2
remark
remark  tests torsion angle dynamics topology setup


param
remarks parameters for hapten

bond cr1e nc2  500. 1.5
bond nc2 o     500. 1.23
bond nc2 ch2e  500. 1.5
bond nc2 ch1e  500. 1.5

angles cr1e cr1e nc2  100. 120.
angles cr1e nc2 o     100. 120.
angles o nc2 o        100. 120.
angles cr1e nc2 ch2e  100. 120.
angles nc2 ch2e cr2e  100. 109.5
angles cr1e nc2 ch1e  100. 120.
angles ch2e ch1e ch2e 100. 109.5
angles ch1e nc2  o    100. 120.
angles nc2 ch1e ch2e  100. 109.5
angles nc2 ch1e ch3e  100. 109.5
angles ch1e nc2 ch1e  100. 120. 
angles nc2 ch2e ch2e  100. 109.5



improper nc2 cr1e o o 250. 0 0.0
improper nc2 o ch1e ch1e 250. 0 0.0
improper o nc2 cr1e cr1e 250. 0 0.0
   @CNS_TOPPAR:protein.param
end

stru
data_cns_mtf

_cns_mtf.title
; FILENAME="/data/rwgk/test/tmp.mtf"
  parameters for hapten
  DATE:18-Nov-98  14:17:47       created by user: rwgk
  VERSION:0.4a
;

loop_
_cns_mtf_atom.id
_cns_mtf_atom.segment_id
_cns_mtf_atom.residue_id
_cns_mtf_atom.residue_name
_cns_mtf_atom.atom_name
_cns_mtf_atom.chemical_type
_cns_mtf_atom.charge
_cns_mtf_atom.atom_mass
1 ' ' '250' 'DNP' 'C4' 'CR1E' 0.000000E+00 13.0190
2 ' ' '250' 'DNP' 'C5' 'CR1E' 0.000000E+00 13.0190
3 ' ' '250' 'DNP' 'C6' 'CR1E' 0.000000E+00 13.0190
4 ' ' '250' 'DNP' 'C7' 'CR1E' 0.000000E+00 13.0190
5 ' ' '250' 'DNP' 'C8' 'CR1E' 0.000000E+00 13.0190
6 ' ' '250' 'DNP' 'C9' 'CR1E' 0.000000E+00 13.0190
7 ' ' '250' 'DNP' 'N2' 'NC2' 0.000000E+00 14.0067
8 ' ' '250' 'DNP' 'O10' 'O' 0.000000E+00 15.9994
9 ' ' '250' 'DNP' 'O11' 'O' 0.000000E+00 15.9994
10 ' ' '250' 'DNP' 'N3' 'NC2' 0.000000E+00 14.0067
11 ' ' '250' 'DNP' 'O12' 'O' 0.000000E+00 15.9994
12 ' ' '250' 'DNP' 'O13' 'O' 0.000000E+00 15.9994
13 ' ' '250' 'DNP' 'N15' 'NC2' 0.000000E+00 14.0067
14 ' ' '250' 'DNP' 'C48' 'CH2E' 0.000000E+00 14.0270
15 ' ' '250' 'DNP' 'C49' 'CH2E' 0.000000E+00 14.0270
16 ' ' '250' 'DNP' 'N50' 'NH3' 0.000000E+00 14.0067
17 ' ' '250' 'DNP' 'N1' 'NC2' 0.000000E+00 14.0067
18 ' ' '250' 'DNP' 'C19' 'CH1E' 0.000000E+00 13.0190
19 ' ' '250' 'DNP' 'C20' 'CH2E' 0.000000E+00 14.0270
20 ' ' '250' 'DNP' 'C21' 'CH1E' 0.000000E+00 13.0190
21 ' ' '250' 'DNP' 'C22' 'CH2E' 0.000000E+00 14.0270
22 ' ' '250' 'DNP' 'C23' 'CH1E' 0.000000E+00 13.0190
23 ' ' '250' 'DNP' 'N18' 'NC2' 0.000000E+00 14.0067
24 ' ' '250' 'DNP' 'C24' 'CH3E' 0.000000E+00 15.0350
25 ' ' '250' 'DNP' 'C25' 'CH3E' 0.000000E+00 15.0350
26 ' ' '250' 'DNP' 'C26' 'CH3E' 0.000000E+00 15.0350
27 ' ' '250' 'DNP' 'C27' 'CH3E' 0.000000E+00 15.0350
28 ' ' '250' 'DNP' 'O28' 'O' 0.000000E+00 15.9994
-1 ' ' ' ' ' ' ' ' ' ' -1.00000 -1.00000

loop_
_cns_mtf_bond.id[1]
_cns_mtf_bond.id[2]
1 2
2 3
3 4
4 5
5 6
6 1
2 7
7 8
7 9
4 10
10 12
10 11
5 13
13 14
14 15
15 16
1 17
17 20
20 19
19 18
18 23
23 22
22 21
21 20
22 26
22 27
18 24
18 25
23 28
-1 -1

loop_
_cns_mtf_angle.id[1]
_cns_mtf_angle.id[2]
_cns_mtf_angle.id[3]
1 2 3
2 1 6
1 2 7
2 1 17
2 3 4
3 2 7
3 4 5
3 4 10
4 5 6
5 4 10
4 5 13
5 6 1
6 5 13
6 1 17
2 7 8
2 7 9
8 7 9
4 10 12
4 10 11
12 10 11
5 13 14
13 14 15
14 15 16
1 17 20
17 20 19
17 20 21
20 19 18
19 20 21
19 18 23
19 18 24
19 18 25
18 23 22
23 18 24
23 18 25
18 23 28
23 22 21
23 22 26
23 22 27
22 23 28
22 21 20
21 22 26
21 22 27
26 22 27
24 18 25
-1 -1 -1

loop_
_cns_mtf_dihedral.id[1]
_cns_mtf_dihedral.id[2]
_cns_mtf_dihedral.id[3]
_cns_mtf_dihedral.id[4]
-1 -1 -1 -1

loop_
_cns_mtf_improper.id[1]
_cns_mtf_improper.id[2]
_cns_mtf_improper.id[3]
_cns_mtf_improper.id[4]
1 6 5 4
6 5 4 3
5 4 3 2
4 3 2 1
3 2 1 6
2 1 6 5
4 10 5 3
1 17 6 2
2 7 1 3
5 13 6 4
7 2 8 9
10 4 12 11
23 28 22 18
8 7 2 1
11 10 4 5
-1 -1 -1 -1

loop_
_cns_mtf_explicit_nonbonded_exclusion.inb
-1

loop_
_cns_mtf_explicit_nonbonded_exclusion.iblo
0
0
0
0
0
0
0
0
0
0
0
0
0
0
0
0
0
0
0
0
0
0
0
0
0
0
0
0
-1

loop_
_cns_mtf_group_linked_list.first_atom_id
0
-1

end

coor
REMARK FILENAME=""
REMARK parameters for hapten
REMARK DATE:07-Mar-94  10:01:43       created by user: luke
ATOM      1  C4  DNP   250      -4.070  58.954 181.339  1.00  0.00          
ATOM      2  C5  DNP   250      -4.397  57.652 181.786  1.00  0.00          
ATOM      3  C6  DNP   250      -3.886  57.216 182.993  1.00  0.00          
ATOM      4  C7  DNP   250      -3.073  57.998 183.762  1.00  0.00          
ATOM      5  C8  DNP   250      -2.776  59.306 183.363  1.00  0.00          
ATOM      6  C9  DNP   250      -3.276  59.769 182.140  1.00  0.00          
ATOM      7  N2  DNP   250      -5.232  56.631 181.038  1.00  0.00          
ATOM      8  O10 DNP   250      -5.672  56.890 179.928  1.00  0.00          
ATOM      9  O11 DNP   250      -5.498  55.521 181.536  1.00  0.00          
ATOM     10  N3  DNP   250      -2.350  57.293 184.894  1.00  0.00          
ATOM     11  O12 DNP   250      -1.442  57.830 185.538  1.00  0.00          
ATOM     12  O13 DNP   250      -2.637  56.135 185.215  1.00  0.00          
ATOM     13  N15 DNP   250      -2.023  60.259 184.273  1.00  0.00          
ATOM     14  C48 DNP   250      -0.492  60.325 184.397  1.00  0.00          
ATOM     15  C49 DNP   250       0.244  60.842 183.090  1.00  0.00          
ATOM     16  N50 DNP   250       1.548  60.228 182.786  1.00  0.00          
ATOM     17  N1  DNP   250      -4.361  59.463 179.967  1.00  0.00          
ATOM     18  C19 DNP   250      -5.835  62.452 179.972  1.00  0.00          
ATOM     19  C20 DNP   250      -6.330  61.006 180.189  1.00  0.00          
ATOM     20  C21 DNP   250      -5.715  59.841 179.453  1.00  0.00          
ATOM     21  C22 DNP   250      -5.660  60.218 177.976  1.00  0.00          
ATOM     22  C23 DNP   250      -5.051  61.580 177.558  1.00  0.00          
ATOM     23  N18 DNP   250      -5.335  62.690 178.548  1.00  0.00          
ATOM     24  C24 DNP   250      -4.679  62.716 180.975  1.00  0.00          
ATOM     25  C25 DNP   250      -6.915  63.453 180.393  1.00  0.00          
ATOM     26  C26 DNP   250      -3.494  61.531 177.487  1.00  0.00          
ATOM     27  C27 DNP   250      -5.541  61.954 176.157  1.00  0.00          
ATOM     28  O28 DNP   250      -5.035  63.857 178.181  1.00  0.00          
END

set message=all end

dyna torsion
   nstep=0
   cmremove=false
   topology
      free bond (name N1) (name C21)
      fix group (name C4 or name C5 or name C6 or name C7 or name C8 or name C9)
      kdihmax=1000.
   end
end

dyna tors
   nstep=0
   cmremove=false
   topology
      reset
   end
end

dyna tors
   nstep=0
   cmremove=false
   topology
      free bond (name N18) (name C19)
      fix torsion (name C22) (name C21) (name N1) (name C4)
      kdihmax=1000
   end
end

dyna tors
   nstep=0
   cmremove=false
   topology
      reset
   end
end

dyna tors
   nstep=0
   cmremove=false
   topology
      free bond (name N18) (name C19)
      kdihmax = 1
   end
end

stop
