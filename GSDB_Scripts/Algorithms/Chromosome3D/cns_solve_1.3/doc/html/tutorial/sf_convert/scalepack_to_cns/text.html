<HTML>
<HEAD>
   <TITLE>Crystallography & NMR System</TITLE>
</HEAD>
<BODY BGCOLOR=#8ebf8e>

<HR WIDTH="100%"></P>

<H2>Converting a scalepack reflection file</H2>

<HR WIDTH="100%"></P>
   
A scalepack file processed with or without <TT>scale anomalous</TT>
can be converted to CNS reflection file format using the command
<TT>to_cns</TT>.

<PRE>
      to_cns <A HREF="../../data/nsf/native.sca">native.sca</A> <A HREF="../../data/nsf/native.hkl">native.hkl</A>
</PRE>

The <TT>to_cns</TT> program does not apply the Bayesian statistics
used in programs such as <TT>truncate</TT>. The following rules are
followed to convert data:

<PRE>
if I >= 0 and sigI < I:

      F = sqrt(I)
      sigF = F - sqrt(I - sigI)

if I >= 0 and sigI >= I:

      F = sqrt(I)
      sigF = F

if I < 0:

      F = 0
      sigF = 0
</PRE>

The output of the program <TT>to_cns</TT> is a CNS formatted
reflection file. This will contain a header which describes the data
items in the file, followed by the data items themselves. The file is
plain ASCII and can be viewed with any text viewer/editor. Example
header from a CNS reflection file created by <TT>to_cns</TT>:

<PRE>
{* CNS file native.hkl converted from hkl file native.sca
   Converted by program to_cns *}
NREFlections= 25615
ANOMalous= FALSe
DECLare NAME=IOBS  DOMAin=RECIprocal TYPE=REAL END
DECLare NAME=SIGI  DOMAin=RECIprocal TYPE=REAL END
DECLare NAME=FOBS  DOMAin=RECIprocal TYPE=REAL END
DECLare NAME=SIGMA DOMAin=RECIprocal TYPE=REAL END
INDEx=    0    0    3 IOBS=   1097015.00 SIGI=     38671.00
                      FOBS=    1047.38 SIGMA=      18.63
INDEx=    0    0    6 IOBS=     38949.80 SIGI=      1168.10
                      FOBS=     197.36 SIGMA=       2.98
INDEx=    0    0    7 IOBS=    204157.00 SIGI=      4424.00
                      FOBS=     451.84 SIGMA=       4.92
</PRE>

<P>If you wish to use <TT>truncate</TT> the scalepack file must be
converted to MTZ format. <TT>truncate</TT> can then be used to
generate a modified MTZ file. This MTZ file can be converted to CNS
format using <TT>mtz2various</TT> or <TT>sftools</TT>. It is important
to check that the header of the CNS reflection file is present and
correct.</P>

<A HREF="tutorial.csh">Script to run this tutorial</A>

<HR WIDTH="100%"></P>

<A HREF="../../text.html">Back to tutorials</A>&nbsp;&nbsp;
<A HREF="../mtz_to_cns/text.html">Next section</A>

<HR WIDTH="100%"></P>
   
</BODY>
</HTML>
