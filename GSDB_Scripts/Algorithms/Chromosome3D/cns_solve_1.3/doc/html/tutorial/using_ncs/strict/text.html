<HTML>
<HEAD>
   <TITLE>Crystallography & NMR System</TITLE>
</HEAD>
<BODY BGCOLOR=#8ebf8e>

<HR WIDTH="100%"></P>

<H2>Strict NCS (constraints) in refinement</H2>

<HR WIDTH="100%"></P>

<P>Non-crystallographic symmetry (NCS) can (and in many cases should) be
included in refinement. In CNS two models for NCS are available:</P>

<UL>
<LI>Strict (constraints) - the model consists of a protomer. Matrices
explicitly define the relationship between protomers. These matrices
are used to generate the complete asymmetric unit. The relationships
between protomers are fixed because the matrices do not change during
refinement. </LI>

<LI>Restrained (restraints) - the model consists of all protomers. The
relationship between protomers is defined by selections of equivalent
atoms. These relationships are used to superimpose all related
molecules and calculate deviations from the average structure. The
relationships between protomers are not fixed because the matrices
used to superimpose protomers are constantly changing during
refinement. </LI>
</UL>

<P>Non-crystallographic symmetry is defined with the CNS auxiliary
file <TT>ncs.def</TT>. This has sections for strict NCS and NCS
restraints (either one or the other or both can be used). Here we will perform a simulated annealing refinement for a model with
strict NCS with two molecules in the asymmetric unit. The model
consists of a single protomer and the strict NCS matrix that is used
internally to generate the dimer. The strict NCS symmetry is defined
with the CNS task file <A HREF="ncs_strict.def">ncs_strict.def</A>.
The matrices could have come from experimental phasing or, as in this
case, from analysis of the two molecules located by molecular
replacement. The CNS task file <TT>get_ncs_matrices.inp</TT> can be
used to determine NCS operators between molecules. The operators are
defined as realspace rotation and translation:</P>

<FORM ACTION="" NAME=f1 METHOD=POST>
<TABLE BGCOLOR=WHITE BORDER=1 WIDTH="100%">
  <TR><TD COLSPAN=3 BGCOLOR=#698B69><CENTER>
    <FONT FACE=helvetica COLOR=white><BIG><B>strict NCS (X-ray and nonbonded terms)
    </B></BIG></FONT></CENTER></TD></TR>
  <TR><TD COLSPAN=3>
    <B> these operators are used to generate the complete asymmetric unit for structure factor and nonbonded energy calculations </B><BR>

  <TR><TD COLSPAN=3>
    <B> NCS operator 1 - the identity operator </B><BR>

  <TR><TD COLSPAN=2 ALIGN=RIGHT>
    <B> use this operator </B><BR>
    </TD><TD >
<TABLE><TR>
    <TD><INPUT TYPE=RADIO NAME=ncs_op_1 VALUE="true" CHECKED>true</TD>
    <TD><INPUT TYPE=RADIO NAME=ncs_op_1 VALUE="false">false</TD>
</TR></TABLE>
    </TD></TR>
  <TR><TD COLSPAN=3>
    <B> real-space rotation matrix </B><BR>

    </TD></TR>
  <TR><TD COLSPAN=3><TEXTAREA NAME=ncs_matrix_1 ROWS=3 COLS=60>
( 1 0 0 )
( 0 1 0 )
( 0 0 1 )</TEXTAREA>
    <INPUT TYPE=BUTTON VALUE='More Lines'>
    </TD></TR>
  <TR><TD COLSPAN=3>
    <B> real-space translation vector </B><BR>

    </TD></TR>
  <TR><TD COLSPAN=3><TEXTAREA NAME=ncs_vector_1_paren ROWS=2 COLS=60>
0 0 0</TEXTAREA>
    <INPUT TYPE=BUTTON VALUE='More Lines'>
    </TD></TR>
  <TR><TD COLSPAN=3>
    <B> NCS operator 2 </B><BR>

  <TR><TD COLSPAN=2 ALIGN=RIGHT>
    <B> use this operator </B><BR>
    </TD><TD >
<TABLE><TR>
    <TD><INPUT TYPE=RADIO NAME=ncs_op_2 VALUE="true" CHECKED>true</TD>
    <TD><INPUT TYPE=RADIO NAME=ncs_op_2 VALUE="false">false</TD>
</TR></TABLE>
    </TD></TR>
  <TR><TD COLSPAN=3>
    <B> real-space rotation matrix </B><BR>

    </TD></TR>
  <TR><TD COLSPAN=3><TEXTAREA NAME=ncs_matrix_2 ROWS=3 COLS=60>
(  0.24218  0.24708 -0.93824 )
(  0.30835 -0.93649 -0.16702 )
( -0.91993 -0.24886 -0.30299 )</TEXTAREA>
    <INPUT TYPE=BUTTON VALUE='More Lines'>
    </TD></TR>
  <TR><TD COLSPAN=3>
    <B> real-space translation vector </B><BR>

    </TD></TR>

  <TR><TD COLSPAN=3><TEXTAREA NAME=ncs_vector_2_paren ROWS=2 COLS=60>35.02347   32.17915   55.41964</TEXTAREA>
    <INPUT TYPE=BUTTON VALUE='More Lines'>
    </TD></TR>
</TABLE>
</FORM>

<P>&nbsp;</P>
<P>Note that in the case of strict NCS in CNS the matrices defined
  only are used to generate the full asymmetric unit for the purposes of
  structure factor calculation and nonbonded interactions within the
  asymmetric unit between NCS related protomers. Symmetry related
  interactions are only calculate for the protomer in the model
  (ie. symmetry is not applied to the NCS operators). In some cases this
  can lead to missing symmetry related interactions between the protomer
  in the model and NCS related protomers. This can be overcome by
  defining matrices that are only used for nonbonded interactions. There
is a section in the ncs.def file for this:</P>

<FORM ACTION="" NAME=f2 METHOD=POST>
<TABLE BGCOLOR=WHITE BORDER=1 WIDTH="100%">
  <TR><TD COLSPAN=3 BGCOLOR=#698B69><CENTER>
    <FONT FACE=helvetica COLOR=white><BIG><B>strict NCS (nonbonded term only)
    </B></BIG></FONT></CENTER></TD></TR>
  <TR><TD COLSPAN=3>
    <B> these operators can be used to generate the full nonbonded environment around the protomer </B><BR>

  <TR><TD COLSPAN=3>
    <B> NCS nonbonded operator 1 </B><BR>

  <TR><TD COLSPAN=2 ALIGN=RIGHT>
    <B> use this operator </B><BR>
    </TD><TD >
<TABLE><TR>
    <TD><INPUT TYPE=RADIO NAME=nb_ncs_op_1 VALUE="true">true</TD>
    <TD><INPUT TYPE=RADIO NAME=nb_ncs_op_1 VALUE="false" CHECKED>false</TD>
</TR></TABLE>
    </TD></TR>
  <TR><TD COLSPAN=3>
    <B> real-space rotation matrix </B><BR>

    </TD></TR>
  <TR><TD COLSPAN=3><TEXTAREA NAME=nb_ncs_matrix_1 ROWS=3 COLS=60>
( 1 0 0 )
( 0 1 0 )
( 0 0 1 )</TEXTAREA>
    <INPUT TYPE=BUTTON VALUE='More Lines'>
    </TD></TR>
  <TR><TD COLSPAN=3>
    <B> real-space translation vector </B><BR>

    </TD></TR>
  <TR><TD COLSPAN=3><TEXTAREA NAME=nb_ncs_vector_1_paren ROWS=2 COLS=60>
0 0 0</TEXTAREA>
    <INPUT TYPE=BUTTON VALUE='More Lines'>
    </TD></TR>
  <TR><TD COLSPAN=3>
    <B> NCS nonbonded operator 2 </B><BR>

  <TR><TD COLSPAN=2 ALIGN=RIGHT>
    <B> use this operator </B><BR>
    </TD><TD >
<TABLE><TR>
    <TD><INPUT TYPE=RADIO NAME=nb_ncs_op_2 VALUE="true">true</TD>
    <TD><INPUT TYPE=RADIO NAME=nb_ncs_op_2 VALUE="false" CHECKED>false</TD>
</TR></TABLE>
    </TD></TR>
  <TR><TD COLSPAN=3>
    <B> real-space rotation matrix </B><BR>

    </TD></TR>
  <TR><TD COLSPAN=3><TEXTAREA NAME=nb_ncs_matrix_2 ROWS=3 COLS=60>
( 1 0 0 )
( 0 1 0 )
( 0 0 1 )</TEXTAREA>
    <INPUT TYPE=BUTTON VALUE='More Lines'>
    </TD></TR>
  <TR><TD COLSPAN=3>
    <B> real-space translation vector </B><BR>

    </TD></TR>
  <TR><TD COLSPAN=3><TEXTAREA NAME=nb_ncs_vector_2_paren ROWS=2 COLS=60>0 0 0</TEXTAREA>
    <INPUT TYPE=BUTTON VALUE='More Lines'>
    </TD></TR>
</TABLE>
</FORM>

<P>As an example we perform round of simulated annealing refinement, followed by positional minimization and B-factor refinement in the presence of  strict NCS:</P>
<PRE>
      cns_solve &lt; <A HREF="refine.inp">refine.inp</A> &gt; refine.out</PRE>
<p><br>
  <br>The resulting PDB file header starts with:<br>
</p>
<PRE>   
REMARK coordinates from positional and B-factor refinement
REMARK cycles= 1
REMARK refinement resolution: 500 - 1.8 A
REMARK starting r= 0.4340 free_r= 0.4436
REMARK final    r= 0.3836 free_r= 0.4155
</PRE>
<p><br>
  Note that the header also contains information about the fact that strict NCS is used:<br>
  <br>
</p>
<PRE>REMARK ncs= strict  ncs file= ncs_strict.def

 </PRE>
<BR><A HREF="tutorial.csh">Script to run this tutorial</A>

<HR WIDTH="100%"></P>

<A HREF="../../text.html">Back to tutorials</A>&nbsp;&nbsp;
<A HREF="../restrain/text.html">Next section</A>

<HR WIDTH="100%"></P>
   
</BODY>
</HTML>
